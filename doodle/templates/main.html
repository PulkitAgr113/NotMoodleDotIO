{% extends "base.html" %}
{% load static %}

{% block title %}
main page
{% endblock title %}

{% block content %}
    <input type="hidden" value={{loggedin.username}} id="username">
    <input type="hidden" value={{room.room_code}} id="room_id">
    <input type="hidden" value={{canvas_url}} id="canvasURL">
    <input type="hidden" value={{start}} id="startTime">
    <input type="hidden" value={{room.started}} id="started">
    
    <div class="row h-100">
        <div class="typing"><h2> Doodled!</h2></div>
        <div class="col-3 col-xl-3">
            <h2>Room {{room.room_code}}</h2>
            <div class="card">
                {% for player in room.players.all %}
                    <div class = "player-container">
                        <b> {{player.username}} </b>
                        {{player.user_score.score}}
                    </div>
                {% endfor %}
            </div>
            <div id="alert-box"></div>
            {% if room.owner != loggedin or room.started %}
                <button class="btn btn-secondary mt-2" value = "over" id = "start_game">Start Game</button><br>
            {% else %}
                <button class="btn btn-primary mt-2" value = "working" id = "start_game">Start Game</button><br>
            {% endif %}
            <button class="btn btn-primary mt-2" id = "leave_room">Leave Room</button><br><br>
            {% if room.owner == loggedin %}
                <h3>{{room.word}}</h3>
            {% else %}
                {% for char in room.word %}
                    {% if char != " " %}
                        <b>*</b>
                    {% else %}
                        &nbsp;
                    {% endif %}
                {% endfor %}
            {% endif %}
            <h4 id = "time">Time left:</h4>
        </div>
        <div class="col-6 col-xl-6">
            <canvas class="whiteboard"></canvas>
            <div class="colors">
                <div class="color black"></div>
                <div class="color red"></div>
                <div class="color green"></div>
                <div class="color blue"></div>
                <div class="color yellow"></div>
                <div class="color white"></div>
            </div>
        </div>
        
        <div class="col-3 col-xl-3">
            <!-- Content here -->

            <!-- 
                Some background images
                https://www.freecodecamp.org/news/content/images/size/w2000/2021/06/w-qjCHPZbeXCQ-unsplash.jpg
                https://amymhaddad.s3.amazonaws.com/morocco-blue.png
             -->
            <div class="container chatbox" id="messages-box" style= "background-image: url(https://amymhaddad.s3.amazonaws.com/morocco-blue.png)">
                {% for msg in chat_messages %}
                    {% if msg.author == loggedin.username %}
                        <div class="row justify-content-end" style="margin-bottom: 10px;">
                        <div class="col-4 msg-self">
                        <b>{{msg.author}}</b><br>
                        {{msg.text}}
                        </div></div>
                    {% else %}
                        <div class="row justify-content-start" style="margin-bottom: 10px;">
                        <div class="col-4 msg-other">
                        <b>{{msg.author}}</b><br>
                        {{msg.text}}
                        </div></div>
                    {% endif %}
                {% endfor %}
            </div>
            <div class="row">
                <div class="col">
                    <input type="text" id="message-input" class="form-control" placeholder="Message">
                    <button class="btn btn-primary mt-2" id="send-btn">{% csrf_token %}Send</button>
                </div>
            </div>
        </div>
    </div>

{% endblock content %}
{% block scripts %}
    <script src="{% static 'main.js' %}"></script>
{% endblock scripts %}