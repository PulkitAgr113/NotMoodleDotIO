{% extends 'login-reg-base.html' %}

{% block title %}Menu{% endblock %}

{% block content %}

    <div class= "col align-self-end top-right" 
    style="position: absolute; right: 0; top: 0; color: white; text-align:right;
    font-family: 'Supernatural Knight', sans-serif;"
    > 
      <br>
      <h2>{{username}}</h2>
      <br>
      <a href = "{% url 'logout' %}"><button class="btn btn-warning btn-lg">Logout</button></a>
      <br>
    </div>


    <div class="col-2 container-sm" style=" font-family: 'monaco', monospace;">
      <br>
      <button class="btn btn-primary mt-2" id="join-room">Join Room</button>
      <input id="roomcode" 
        type="text" 
        name="roomcode" 
        class="themed-input" 
        style="text-align: center; font-family: 'Supernatural Knight', sans-serif; color: white; border-bottom: '1px' solid white ;" 
        placeholder="RoomCode"
        >
      <label for="roomcode"></label>		
      

    
    
    <!-- <input type="text" id="room-code" class="form-control text-center" placeholder="Room Code"> -->
    </div>

    <div style=" font-family: 'monaco', monospace; text-align: center;">
    
      
      <a href="{% url 'main1' %}" class="themed-button">
        <span class="inactive">Create Private Game</span>
        <span class="active">&lt Create Private Game &gt</span>
      </a>
      <br>
      <br>
      <a href="{% url 'main0' %}" class="themed-button">
        <span class="inactive">Create Public Game</span>
        <span class="active">&lt Create Public Game &gt</span>
      </a>
      <br>
      <br>
    </div>
  
    <div class="row">
      <div class="col">
        <h3>Registered Users:</h3>
        {% for user in userlist %}
          {% if user.is_superuser %}
          {% else %}
            <h5>{{user}}</h5>
          {% endif %}
        {% endfor %}
      </div>
      <div class="col">
        <h3>Admins:</h3>
        {% for user in userlist %}
          {% if user.is_superuser %}
            <h5>{{user}}</h5>
          {% endif %}
        {% endfor %}
      </div>
      <div class="col">
        <h3> Public Rooms: </h3>
        {% for codes in codelist %}
          {% if codes.room_type == "public" %}
            {% if codes.owner == loggedin %}
              <button class="btn btn-success mt-2 public" value="{{codes}}"> {{codes}} </button>
              <button class = "btn btn-danger mt-2 delete" value="{{codes}}">Delete Room</button>
            {% else %}
              <button class="btn btn-success mt-2 public" value="{{codes}}"> {{codes}} - {{codes.owner_username}} </button>
            {% endif %}
            <br>
          {% endif %}
        {% endfor %}
      </div>
      <div class="col">
        <h3> Your Rooms: </h3>
        {% for codes in codelist %}
          {% if codes.room_type == "private" and codes.owner == loggedin%}
            <button class="btn btn-success mt-2 public" value="{{codes}}"> {{codes}} </button>
            <button class = "btn btn-danger mt-2 delete" value="{{codes}}">Delete Room</button>
            <br>
          {% endif %}
        {% endfor %}
      </div>
    </div>


    <script>
      const joinRoom = document.getElementById('join-room') ;
      const roomCode = document.getElementById('roomcode') ;
      const pub = document.getElementsByClassName('public') ;
      const del = document.getElementsByClassName('delete') ;
  
      joinRoom.addEventListener('click',()=>{
        var code = roomCode.value 
        if(code.length != 6 || code != code.toUpperCase()) {
          alert('Enter a valid room code!');
          return;
        }
        window.location.href = '../lobby/'+code;
      })
  
      Object.entries(pub).map((object)=>{
        object[1].addEventListener('click',()=>{
          var code = object[1].value
          window.location.href = '../lobby/'+code;
        })
      })
  
      Object.entries(del).map((object)=>{
        object[1].addEventListener('click',()=>{
          var code = object[1].value
          window.location.href = '../delete/'+code;
        })
      })
    </script>


{% endblock %}


  
